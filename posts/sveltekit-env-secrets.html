<!DOCTYPE html>
<html lang="en" data-theme="valentine">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.png" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1"
    />
    <meta http-equiv="content-security-policy" content="">
		<link href="../_app/immutable/assets/_layout-223af949.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/start-3d4e7262.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-3e2bf343.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons-879e98ba.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/_layout.svelte-46304a0a.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/site-config-566325af.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/_layout.js-7b9cbfbc.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_layout-8d2a742b.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/posts/_slug_/_page.svelte-f199fb3f.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/head-bcd6e265.js"><title>Post | SvelteKit .env secrets</title><!-- HEAD_svelte-enfip_START --><link rel="canonical"><meta name="description"><meta name="author" content="Eric"><meta itemprop="name" content="Post | SvelteKit .env secrets"><meta itemprop="description"><meta itemprop="image"><meta property="og:url"><meta property="og:type" content="website"><meta property="og:title" content="Post | SvelteKit .env secrets"><meta property="og:description"><meta property="og:image"><meta name="twitter:card" content="summary_large_image"><meta property="twitter:domain" content="https://ericleoo.github.io"><meta property="twitter:url"><meta name="twitter:title" content="Post | SvelteKit .env secrets"><meta name="twitter:description"><meta name="twitter:image"><meta name="monetization" content="$ilp.uphold.com/bzPBWkMBzLmN"><!-- HEAD_svelte-enfip_END -->
  </head>
  <body>
    <div id="svelte">


<div class="bg-neutral shadow-lg text-neutral-content mb-16 top-0 z-10 navbar sticky"><div class="mx-2 px-2 navbar-start"><span class="font-bold text-lg">Eric's Blog</span></div>
  
  <div class="mx-2 px-2 hidden navbar-center lg:flex"><div class="flex items-stretch"><a sveltekit:prefetch href="/" class="rounded-btn btn btn-ghost btn-sm">Home</a></div></div></div>

<main class="mx-auto max-w-[90ch] px-4 relative sm:px-6 lg:px-8 break-normal">

<article class="flex flex-col flex-grow"><h1 class="font-bold mb-5 text-5xl">SvelteKit .env secrets</h1>
  <div class=""><p>Tue Jun 22 2021</p>
    <article class="all-prose"><!-- HTML_TAG_START --><p>So SvelteKit is super awesome n’ all and the best thing ever but have
you ever tried to use a <code>.env</code> secret that you didn’t want exposed on
the client?</p>
<p>SvelteKit uses <a href="https://vitejs.dev/" rel="noopener" target="_blank">Vite</a> and it has a specific way to reference <a href="https://vitejs.dev/guide/env-and-mode.html#env-variables" rel="noopener" target="_blank">Env
Variables and Modes</a>, you reference a <code>.env</code> variable with
<code>({}).VITE_NAME_OF_VARIABLE</code> the <code>VITE_*</code> prefix means in
SvelteKit it makes that variable available on the client.</p>
<h2>What if you have a secret key?</h2>
<p>So if you want a secret key that’s not exposed to the client then,
what? Remove the <code>VITE_*</code> prefix? Well, no, so, how to have secrets??</p>
<p>The answer is don’t use Vite and instead use something to load the
variables from the <code>.env</code> file.</p>
<p>Use <a href="https://www.npmjs.com/package/env-cmd" rel="noopener" target="_blank">env-cmd</a> or <a href="https://www.npmjs.com/package/dotenv" rel="noopener" target="_blank">dotenv</a> or whatever you want to use to ensure the
runtime <code>process.env</code> is populated in dev.</p>
<h2>Example</h2>
<p>Here I have defined my <code>.env</code> file at the root of my project:</p>
<pre class="language-python"><!-- HTML_TAG_START --><code class="language-python">VITE_CLIENT_VARIABLE<span class="token operator">=</span>wheeeeeeeee
SUPER_SECRET_SECRET<span class="token operator">=</span>shhhhhh</code><!-- HTML_TAG_END --></pre>
<p>Then I’ve created a <code>secret.js</code> file to access my secret:</p>
<pre class="language-js"><!-- HTML_TAG_START --><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">API_URL</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'SUPER_SECRET_SECRET'</span><span class="token punctuation">]</span></code><!-- HTML_TAG_END --></pre>
<p>Then I’ve added <code>env-cmd</code> to my <code>dev</code> script in my <code>package.json</code> so
that <code>process.env</code> has the super secret secret populated:</p>
<pre class="language-json"><!-- HTML_TAG_START --><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"env-cmd svelte-kit dev"</span><span class="token punctuation">,</span></code><!-- HTML_TAG_END --></pre>
<p>Now I can access my super secret secret and have client side variables
too.</p>
<h2>Thanks!</h2>
<p>A kind thank you to Discord users <code>Xyo</code> and especially <code>saikatdas0790</code>
on the Svelte Discord <code>svelte-kit</code> channel for helping me out with
this!</p><!-- HTML_TAG_END --></article></div></article>
</main>


		<script type="module" data-sveltekit-hydrate="rxcp5k">
			import { start } from "../_app/immutable/start-3d4e7262.js";

			start({
				env: {},
				hydrate: {
					status: 200,
					error: null,
					node_ids: [0, 3],
					params: {slug:"sveltekit-env-secrets"},
					route: {"id":"/posts/[slug]"},
					data: [null,{type:"data",data:{html:"\u003Cp\u003ESo SvelteKit is super awesome n’ all and the best thing ever but have\nyou ever tried to use a \u003Ccode\u003E.env\u003C\u002Fcode\u003E secret that you didn’t want exposed on\nthe client?\u003C\u002Fp\u003E\n\u003Cp\u003ESvelteKit uses \u003Ca href=\"https:\u002F\u002Fvitejs.dev\u002F\" rel=\"noopener\" target=\"_blank\"\u003EVite\u003C\u002Fa\u003E and it has a specific way to reference \u003Ca href=\"https:\u002F\u002Fvitejs.dev\u002Fguide\u002Fenv-and-mode.html#env-variables\" rel=\"noopener\" target=\"_blank\"\u003EEnv\nVariables and Modes\u003C\u002Fa\u003E, you reference a \u003Ccode\u003E.env\u003C\u002Fcode\u003E variable with\n\u003Ccode\u003E({}).VITE_NAME_OF_VARIABLE\u003C\u002Fcode\u003E the \u003Ccode\u003EVITE_*\u003C\u002Fcode\u003E prefix means in\nSvelteKit it makes that variable available on the client.\u003C\u002Fp\u003E\n\u003Ch2\u003EWhat if you have a secret key?\u003C\u002Fh2\u003E\n\u003Cp\u003ESo if you want a secret key that’s not exposed to the client then,\nwhat? Remove the \u003Ccode\u003EVITE_*\u003C\u002Fcode\u003E prefix? Well, no, so, how to have secrets??\u003C\u002Fp\u003E\n\u003Cp\u003EThe answer is don’t use Vite and instead use something to load the\nvariables from the \u003Ccode\u003E.env\u003C\u002Fcode\u003E file.\u003C\u002Fp\u003E\n\u003Cp\u003EUse \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fenv-cmd\" rel=\"noopener\" target=\"_blank\"\u003Eenv-cmd\u003C\u002Fa\u003E or \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fdotenv\" rel=\"noopener\" target=\"_blank\"\u003Edotenv\u003C\u002Fa\u003E or whatever you want to use to ensure the\nruntime \u003Ccode\u003Eprocess.env\u003C\u002Fcode\u003E is populated in dev.\u003C\u002Fp\u003E\n\u003Ch2\u003EExample\u003C\u002Fh2\u003E\n\u003Cp\u003EHere I have defined my \u003Ccode\u003E.env\u003C\u002Fcode\u003E file at the root of my project:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-python\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-python\"\u003EVITE_CLIENT_VARIABLE\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003Ewheeeeeeeee\nSUPER_SECRET_SECRET\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003Eshhhhhh\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThen I’ve created a \u003Ccode\u003Esecret.js\u003C\u002Fcode\u003E file to access my secret:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-js\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token keyword\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\"token constant\"\u003EAPI_URL\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E process\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eenv\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'SUPER_SECRET_SECRET'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThen I’ve added \u003Ccode\u003Eenv-cmd\u003C\u002Fcode\u003E to my \u003Ccode\u003Edev\u003C\u002Fcode\u003E script in my \u003Ccode\u003Epackage.json\u003C\u002Fcode\u003E so\nthat \u003Ccode\u003Eprocess.env\u003C\u002Fcode\u003E has the super secret secret populated:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-json\"\u003E\u003C!-- HTML_TAG_START --\u003E\u003Ccode class=\"language-json\"\u003E\u003Cspan class=\"token property\"\u003E\"scripts\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E&#123;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token property\"\u003E\"dev\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"env-cmd svelte-kit dev\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C!-- HTML_TAG_END --\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENow I can access my super secret secret and have client side variables\ntoo.\u003C\u002Fp\u003E\n\u003Ch2\u003EThanks!\u003C\u002Fh2\u003E\n\u003Cp\u003EA kind thank you to Discord users \u003Ccode\u003EXyo\u003C\u002Fcode\u003E and especially \u003Ccode\u003Esaikatdas0790\u003C\u002Fcode\u003E\non the Svelte Discord \u003Ccode\u003Esvelte-kit\u003C\u002Fcode\u003E channel for helping me out with\nthis!\u003C\u002Fp\u003E",meta:{date:"2021-06-22T00:00:00.000Z",title:"SvelteKit .env secrets",published:true,slug:void 0}},uses:{params:["slug","post"]}}],
					form: null
				},
				paths: {"base":"","assets":""},
				target: document.querySelector('[data-sveltekit-hydrate="rxcp5k"]').parentNode,
				version: "1670408161021"
			});
		</script>
	</div>
  </body>
</html>
~
